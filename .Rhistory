ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
d2016 <- beetle %>%
filter(year == 2016)
View(d2016)
ggplot(d2016, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(d2016, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
xlab("Management type") +
facet_grid(~ field) +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(d2016, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
#  geom_jitter(width = 0.25) +
xlab("Management type") +
facet_grid(~ field) +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
#  geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
#  geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
## Gail's beetle data
## 12 August 2024
## script to do data reformatting and (hopefully) do some modelling
setwd("C:/Users/notne/Research/GitHub/Gails_beetles")
library(ggplot2)
library(dplyr)
################################################################################
## read in data and make factors for field (field), location of sample (sloc: in crop
## or in margin) and sample number (snum)
## I've calculated abundance and species richness already  in the input data set
## did that in Excel
beetle <- read.csv("beetles.csv")
beetle$field <- factor(substr(beetle$Label, 1, 1))
beetle$sloc <- factor(substr(beetle$Label, 4, 4))
beetle$snum <- factor(substr(beetle$Label, 5, 5))
beetle$year <- factor(substr(beetle$Season.and.Year, 8, 12))
beetle$man <- factor(beetle$Management.Type)
levels(beetle$man) <- c("con","int")
################################################################################
## plots
## plot total abundance by field/year
field_year <- beetle %>%
group_by(field, year) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundance))
ggplot(field_year, aes(x = year, y = tot)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_wrap(~field)
ggplot(field_year, aes(x = field, y = tot)) +
geom_point() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_wrap(~year)
################################################################################
## as above but split additionally by management type
trt <- beetle %>%
group_by(field, year, man) %>%
summarise(meanab = mean(abundance),
sdab = sd(abundance),
nobs = n())
## grid of plots of conventional versus integrated for each field/year
ggplot(trt, aes(x = man, y = meanab)) +
geom_point() +
geom_errorbar(aes(ymin = meanab-(2*sdab), ymax = meanab+(2*sdab), width = 0.25)) +
facet_grid(field ~ year) +
xlab("Management type")
## plot as above but using all the raw data not averaging over all traps
## and separating crop and margin sites by colour
beetle %>%
group_by(field, year, man, sloc)
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
View(beetle)
str(beetle)
beetle$crp <- factor(beetle$crop)
View(beetle)
View(beetle)
beetle$crp <- factor(beetle$Crop)
beetle %>% group_by(crp)
ggplot(beetle, aes(x = crp, y = abundance)) +
geom_jitter(width = 0.15)
ggplot(beetle, aes(x = crp, y = abundance)) +
geom_jitter(width = 0.15) +
facet(~field)
ggplot(beetle, aes(x = crp, y = abundance)) +
geom_jitter(width = 0.15) +
facet_wrap(~field)
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_wrap(~field)
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year)
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year) +
theme(axis.text.x = element_text(angle = 45))
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year) +
theme(axis.text.x = element_text(angle = 90))
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_wrap(~field) +
theme(axis.text.x = element_text(angle = 90))
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15)
install.packages(brms)
install.packages("brms")
plot(cars)
plot(cars)
d2016 <- beetle %>%
filter(year == 2016)
library(brms)
View(d2016)
View(d2016)
View(d2016)
mod1 <- brm(data = d2016,
family = poisson,
formula =
abundance ~ 1,
prior(normal(0, 1.5), class = intercept),
iter - 2000, warmup = 1000, chains = 4, cores = 4,
seed = 5814)
mod1 <- brm(data = d2016,
family = poisson,
formula =
abundance ~ 1,
prior(normal(0, 1.5), class = intercept),
iter = 2000, warmup = 1000, chains = 4, cores = 4,
seed = 5814)
mod1 <- brm(data = d2016,
family = poisson,
formula =
abundance ~ 1,
prior(normal(0, 3), class = "intercept"),
iter = 2000, warmup = 1000, chains = 4, cores = 4,
seed = 5814)
mod1 <- brm(data = d2016,
family = poisson,
formula =
abundance ~ 1 + man,
prior(normal(0, 3), class = "intercept"),
iter = 2000, warmup = 1000, chains = 4, cores = 4,
seed = 5814)
mod1 <- brm(data = d2016,
family = poisson,
formula =
abundance ~ 1 + (1|man),
prior = c(
prior(normal(0, 5), class = "Intercept"),
prior(cauchy(0, 2), class = "sd")  # Prior for standard deviation of group effects
)
)
mod1
## Gail's beetle data
## 12 August 2024
## script to do data reformatting and (hopefully) do some modelling
setwd("C:/Users/notne/Research/GitHub/Gails_beetles")
library(ggplot2)
library(dplyr)
library(brms)
library(lme4)
################################################################################
## read in data and make factors for field (field), location of sample (sloc: in crop
## or in margin) and sample number (snum)
## I've calculated abundance and species richness already  in the input data set
## did that in Excel
beetle <- read.csv("beetles.csv")
beetle$field <- factor(substr(beetle$Label, 1, 1))
beetle$sloc <- factor(substr(beetle$Label, 4, 4))
beetle$snum <- factor(substr(beetle$Label, 5, 5))
beetle$year <- factor(substr(beetle$Season.and.Year, 8, 12))
beetle$man <- factor(beetle$Management.Type)
beetle$crp <- factor(beetle$Crop)
levels(beetle$man) <- c("con","int")
################################################################################
## plots
## plot total abundance by field/year
field_year <- beetle %>%
group_by(field, year) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundance))
ggplot(field_year, aes(x = year, y = tot)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_wrap(~field)
ggplot(field_year, aes(x = field, y = tot)) +
geom_point() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_wrap(~year)
################################################################################
## as above but split additionally by management type
trt <- beetle %>%
group_by(field, year, man) %>%
summarise(meanab = mean(abundance),
sdab = sd(abundance),
nobs = n())
## grid of plots of conventional versus integrated for each field/year
ggplot(trt, aes(x = man, y = meanab)) +
geom_point() +
geom_errorbar(aes(ymin = meanab-(2*sdab), ymax = meanab+(2*sdab), width = 0.25)) +
facet_grid(field ~ year) +
xlab("Management type")
## plot as above but using all the raw data not averaging over all traps
## and separating crop and margin sites by colour
beetle %>%
group_by(field, year, man, sloc)
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
beetle %>% group_by(crp)
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15)
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_wrap(~field) +
theme(axis.text.x = element_text(angle = 90))
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year) +
theme(axis.text.x = element_text(angle = 90))
################################################################################
sumbeet <- beetle %>%
group_by(field, year, man) %>%
summarise(mean = mean(abundance))
View(sumbeet)
ggplot(sumbeet, aes(x = man, y = mean)) +
geom_point() +
facet_grid(~ field) +
xlab("Management type")
ggplot(sumbeet, aes(x = man, y = mean)) +
geom_point() +
geom_line()
facet_grid(~ field) +
xlab("Management type")
ggplot(sumbeet, aes(x = man, y = mean)) +
geom_point() +
geom_line() +
facet_grid(~ field) +
xlab("Management type")
ggplot(sumbeet, aes(x = man, y = mean, grooup = year)) +
geom_point(size = 3) +
geom_line(aes(group = year), color = "grey") +
facet_grid(~ field) +
xlab("Management type")
ggplot(sumbeet, aes(x = man, y = mean, grooup = year)) +
geom_point(size = 3) +
geom_line(aes(group = year), color = "grey") +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet, aes(x = man, y = mean, group = year)) +
geom_point(size = 3) +
geom_line(aes(group = year), color = "grey") +
facet_wrap(~ field) +
xlab("Management type")
sumbeet2 <- beetle %>%
group_by(field, year, man, sloc) %>%
summarise(mean = mean(abundance))
View(sumbeet2)
ggplot(sumbeet, aes(x = man, y = mean, group = year, sloc)) +
geom_point(size = 3) +
geom_line(aes(group = year), color = "grey") +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet2, aes(x = man, y = mean, group = year, sloc)) +
geom_point(size = 3, color = sloc) +
geom_line(aes(group = year), color = "grey") +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet2, aes(x = man, y = mean, group = (year, sloc)) +
ggplot(sumbeet2, aes(x = man, y = mean, group = sloc)) +
geom_point(size = 3, color = sloc) +
geom_line(aes(group = year), color = "grey") +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet2, aes(x = man, y = mean, group = year)) +
geom_point(size = 3, color = sloc) +
geom_line(aes(group = year), color = "grey") +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet2, aes(x = man, y = mean, group = year, colour = sloc)) +
geom_point(size = 3) +
geom_line(aes(group = year), color = "grey") +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(group = interaction(year, sloc)), color = "grey") +
facet_wrap(~ field) +
xlab("Management type"
)
ggplot(sumbeet, aes(x = man, y = mean, group = year)) +
geom_point(size = 3) +
geom_line(aes(group = year), color = year) +
facet_wrap(~ field) +
xlab("Management type")
# Sample data frame
data <- data.frame(
year = rep(1:6, each = 4),
treatment = rep(c("A", "B"), times = 12),
location = rep(c("X", "Y"), each = 2, times = 6),
value = c(5, 7, 6, 8, 7, 9, 9, 11, 8, 10, 6, 9, 7, 11, 8, 12, 9, 11, 7, 10, 8, 13, 9, 14)
)
# Plot using ggplot2
ggplot(data, aes(x = factor(year), y = value, group = interaction(year, location))) +
geom_point(aes(color = treatment), size = 3) +
geom_line(aes(linetype = location, group = interaction(year, location)), color = "grey") +
labs(x = "Year", y = "Value", title = "Treatment Comparison Over Years by Location") +
theme_minimal() +
scale_color_manual(values = c("A" = "blue", "B" = "red"))
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(group = interaction(year, sloc)), color = "grey") +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(group = interaction(year, sloc)), color = factor(year)) +
facet_wrap(~ field) +
xlab("Management type")
str(sumbeet2)
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(color = factor(year), group = interaction(year, sloc))) +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(color = factor(year), group = interaction(year, sloc))) +
facet_wrap(~ field) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin"))
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(color = factor(year), group = interaction(year, sloc))) +
facet_wrap(~ field) +
xlab("Management type") +
scale_color_manual(values = c("C" = "blue", "M" = "red"), guide = guide_legend(title = "Sampling location")) +
scale_line_color_manual(values = c("2011" = "green", "2012" = "purple",
"2013" = "orange", "2014" = "brown",
"2015" = "pink", "2016" = "cyan",
"2017" = "magenta", "2024" = "grey"))
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(color = factor(year), group = interaction(year, sloc))) +
facet_wrap(~ field) +
xlab("Management type") +
scale_color_manual(values = c("C" = "blue", "M" = "red"),
guide = guide_legend(title = "Sampling location")) +
scale_line_color_manual(values = c("2011" = "green", "2012" = "purple",
"2013" = "orange", "2014" = "brown",
"2015" = "pink", "2016" = "cyan",
"2017" = "magenta", "2024" = "grey"))
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(color = factor(year), group = interaction(year, sloc))) +
facet_wrap(~ field) +
xlab("Management type") +
scale_color_manual(values = c("C" = "blue", "M" = "red"),
guide = guide_legend(title = "Sampling location")) +
scale_color_manual(values = c("2011" = "green", "2012" = "purple",
"2013" = "orange", "2014" = "brown",
"2015" = "pink", "2016" = "cyan",
"2017" = "magenta", "2024" = "grey"))
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(color = factor(year), group = interaction(year, sloc))) +
facet_wrap(~ field) +
xlab("Management type") +
scale_color_manual(values = c("C" = "blue", "M" = "red"),
guide = guide_legend(title = "Sampling location")) +
scale_color_manual(values = c("2011" = "green", "2012" = "purple",
"2013" = "orange", "2014" = "brown",
"2015" = "pink", "2016" = "cyan",
"2017" = "magenta", "2024" = "grey"))
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin"))
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
facet_wrap(~ field) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(color = factor(year), group = interaction(year, sloc)))
+
xlab("Management type")
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
facet_wrap(~ field) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(color = factor(year), group = interaction(year, sloc))) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin"))
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
facet_wrap(~ field) +
geom_point(aes(colour = sloc), size = 3) +
geom_line(aes(color = factor(year), group = interaction(year, sloc))) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin"))
labs(color = "Location")
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
facet_wrap(~ field) +
#  geom_point(aes(colour = sloc), size = 3) +
geom_point(aes(fill=factor(sloc)), size=3, shape=21, stroke=0) +
scale_fill_manual(values=color_sloc) +
geom_line(aes(color = factor(year), group = interaction(year, sloc))) +
xlab("Management type")
color_sloc <- c("steelblue", "tomato2")
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
facet_wrap(~ field) +
#  geom_point(aes(colour = sloc), size = 3) +
geom_point(aes(fill=factor(sloc)), size=3, shape=21, stroke=0) +
scale_fill_manual(values=color_sloc) +
geom_line(aes(color = factor(year), group = interaction(year, sloc))) +
xlab("Management type") #+
ggplot(sumbeet2, aes(x = man, y = mean, group = interaction(year, sloc))) +
facet_wrap(~ field) +
#  geom_point(aes(colour = sloc), size = 3) +
geom_point(aes(fill=factor(sloc)), size=3, shape=21, stroke=0) +
scale_fill_manual(values=color_sloc, labels = c("C" = "Crop", "M" = "Margin")) +
geom_line(aes(color = factor(year), group = interaction(year, sloc))) +
xlab("Management type") +
labs(fill="Location", colour="Year")
ggplot(sumbeet, aes(x = man, y = mean, group = year)) +
geom_point(aes(fill=factor(sloc)), size=3, shape=21, stroke=0) +
geom_line(aes(group = year), color = factor(year)) +
facet_wrap(~ field) +
xlab("Management type")
View(sumbeet)
ggplot(sumbeet, aes(x = man, y = mean, group = year)) +
geom_point(aes(fill=factor(sloc)), size=3, shape=21, stroke=0) +
geom_line(aescolor = factor(year), group = year) +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet, aes(x = man, y = mean, group = year)) +
geom_point(aes(fill=factor(sloc)), size=3, shape=21, stroke=0) +
geom_line(aes(color = factor(year), group = year)) +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet, aes(x = man, y = mean, group = year)) +
geom_point(aes(size=3)) +
geom_line(aes(color = factor(year), group = year)) +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet, aes(x = man, y = mean, group = year)) +
geom_point(aes(size=2, color = "grey")) +
geom_line(aes(color = factor(year), group = year)) +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet, aes(x = man, y = mean, group = year)) +
geom_point(size=2, color = "grey") +
geom_line(aes(color = factor(year), group = year)) +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet, aes(x = man, y = mean, group = year)) +
geom_point(size=2, color = "dark grey") +
geom_line(aes(color = factor(year), group = year)) +
facet_wrap(~ field) +
xlab("Management type")
ggplot(sumbeet, aes(x = man, y = mean, group = year)) +
geom_point(size=3) +
geom_line(aes(color = factor(year), group = year)) +
facet_wrap(~ field) +
xlab("Management type")
