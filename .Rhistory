str(beetles)
str(beetle)
# Sample data
data <- data.frame(id = 1:3,
text = c("apple_banana", "orange_grape", "pear_mango"))
# Split the 'text' variable
split_text <- strsplit(as.character(data$text), "_")
# Create two new factor variables
data$fruit1 <- factor(sapply(split_text, `[`, 1))
data$fruit2 <- factor(sapply(split_text, `[`, 2))
# View the updated data frame
print(data)
View(split_text)
split_text <- strsplit(as.character(beetle$Label), " ")
beetle$field <- factor(sapply(split_text, `[`, 1))
beetle$sample2 <- factor(sapply(split_text, `[`, 2))
# Sample data
data <- data.frame(id = 1:3,
text = c("apple", "orange", "pear"))
# Extract the first character and convert to a factor
data$first_char <- factor(substr(data$text, 1, 1))
# View the updated data frame
print(data)
beetle$field <- factor(substr(beetle$Label, 1, 1))
View(beetle)
str(beetle)
beetle$sloc <- factor(substr(beetle$Label, 5, 5))
View(beetle)
beetle$sloc <- factor(substr(beetle$Label, 4, 4))
View(beetle)
beetle$snum <- factor(substr(beetle$Label, 5, 5))
View(beetle)
## script to do data reformatting and (hopefully) do some modelling
setwd("C:/Users/notne/Research/GitHub/Gails_beetles")
library(ggplot2)
beetle <- read.csv("beetles.csv")
beetle$field <- factor(substr(beetle$Label, 1, 1))
beetle$sloc <- factor(substr(beetle$Label, 4, 4))
beetle$snum <- factor(substr(beetle$Label, 5, 5))
beetle$year <- factor(substr(beetle$Season.and.Year, 8, 12))
View(beetle)
field_year <- beetle %>%
group.by(year, field) %>%
summarise(tot = sum(abundance0),
sdtot = sd(abundnace))
field_year <- beetle %>%
group.by(year, field) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundnace))
setwd("C:/Users/notne/Research/GitHub/Gails_beetles")
library(ggplot2)
library(dplyr)
field_year <- beetle %>%
group.by(year, field) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundnace))
field_year <- beetle %>%
group_by(year, field) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundance))
View(beetle)
beetle <- read.csv("beetles.csv")
beetle$field <- factor(substr(beetle$Label, 1, 1))
beetle$sloc <- factor(substr(beetle$Label, 4, 4))
beetle$snum <- factor(substr(beetle$Label, 5, 5))
beetle$year <- factor(substr(beetle$Season.and.Year, 8, 12))
################################################################################
## plots
## get total abundance by field/year
field_year <- beetle %>%
group_by(year, field) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundance))
View(field_year)
ggplot(field_year, aes(x = year, y = tot)) +
geom_point() +
geom_line()
geom_errorbar(aes(ymin = tot-sdtot, ymax = tot+sdtot), width = 2)
facet_wrap(~field) +
field_year <- beetle %>%
group_by(field, year) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundance))
ggplot(field_year, aes(x = year, y = tot)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = tot-sdtot, ymax = tot+sdtot), width = 2) +
facet_wrap(~field)
ggplot(field_year, aes(x = year, y = tot)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = tot-sdtot, ymax = tot+sdtot), width = 1) +
facet_wrap(~field)
ggplot(field_year, aes(x = field, y = tot)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = tot-sdtot, ymax = tot+sdtot), width = 1) +
facet_wrap(~year)
ggplot(field_year, aes(x = year, y = tot)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = tot-sdtot, ymax = tot+sdtot), width = 0.5) +
facet_wrap(~field)
ggplot(field_year, aes(x = field, y = tot)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = tot-sdtot, ymax = tot+sdtot), width = 0.5) +
facet_wrap(~year)
View(field_year)
View(field_year)
ggplot(field_year, aes(x = year, y = tot)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_wrap(~field)
View(beetle)
## Gail's beetle data
## 12 August 2024
## script to do data reformatting and (hopefully) do some modelling
setwd("C:/Users/notne/Research/GitHub/Gails_beetles")
library(ggplot2)
library(dplyr)
################################################################################
## read in data and make factors for field (field), location of sample (sloc: in crop
## or in margin) and sample number (snum)
## I've calculated abundance and species richness already  in the input data set
## did that in Excel
beetle <- read.csv("beetles.csv")
beetle$field <- factor(substr(beetle$Label, 1, 1))
beetle$sloc <- factor(substr(beetle$Label, 4, 4))
beetle$snum <- factor(substr(beetle$Label, 5, 5))
beetle$year <- factor(substr(beetle$Season.and.Year, 8, 12))
################################################################################
## plots
## get total abundance by field/year
field_year <- beetle %>%
group_by(field, year) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundance))
ggplot(field_year, aes(x = year, y = tot)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_wrap(~field)
ggplot(field_year, aes(x = field, y = tot)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_wrap(~year)
################################################################################
View(beetle)
trt <- beetle %>%
group_by(field, year, Management.Type) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundance))
View(trt)
ggplot(trt, aes(x = year, y = tot)) +
geom_point() +
geom_jitter() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_wrap(~field)
View(beetle)
View(beetle)
ggplot(trt, aes(x = Management.Type, y = tot)) +
geom_point() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_grid(field ~ year)
View(beetle)
beetle %>%
group_by(field, year, Management.Type)
ggplot(beetle, aes(x = Management.Type, y = abundance)) +
geom_point() +
facet_grid(field ~ year)
ggplot(beetle, aes(x = Management.Type, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter() +
facet_grid(field ~ year)
levels(Management.Type)
levels(beetle$Management.Type)
str(beetle)
beetle$man <- factor(beetle$Management.Type)
View(beetle)
levels(beetle$man)
levels(beetle$man) <- c("con","int")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.2) +
facet_grid(field ~ year)
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year)
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
labs(fill = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "red", "M" = "blue"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "red", "M" = "cyan"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "blue", "M" = "red"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "light blue", "M" = "red"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
View(trt)
trt <- beetle %>%
group_by(field, year, man) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundance),
nobs = n(abundance)
View(trt)
trt <- beetle %>%
group_by(field, year, man) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundance),
nobs = n(abundance))
trt <- beetle %>%
group_by(field, year, man) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundance),
nobs = n())
View(trt)
ggplot(trt, aes(x = man, y = tot)) +
geom_point() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_grid(field ~ year)
trt <- beetle %>%
group_by(field, year, man) %>%
summarise(meanab = mean(abundance),
sdtot = sd(abundance),
nobs = n())
trt <- beetle %>%
group_by(field, year, man) %>%
summarise(meanab = mean(abundance),
sdab = sd(abundance),
nobs = n())
## grid of plots of conventional versus integrated for each field/year
ggplot(trt, aes(x = man, y = meanab)) +
geom_point() +
geom_errorbar(aes(ymin = meanab-(2*sdab), ymax = meanab+(2*sdab), width = 0.25)) +
facet_grid(field ~ year)
ggplot(trt, aes(x = man, y = meanab)) +
geom_point() +
geom_errorbar(aes(ymin = meanab-(2*sdab), ymax = meanab+(2*sdab), width = 0.25)) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
beetle %>%
group_by(field, year, man)
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
View(beetle)
beetle %>%
group_by(field, year, man, sloc)
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
d2016 <- beetle %>%
filter(year == 2016)
View(d2016)
ggplot(d2016, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(d2016, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
geom_jitter(width = 0.25) +
xlab("Management type") +
facet_grid(~ field) +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(d2016, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
#  geom_jitter(width = 0.25) +
xlab("Management type") +
facet_grid(~ field) +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_point() +
#  geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
#  geom_point() +
geom_jitter(width = 0.25) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
## Gail's beetle data
## 12 August 2024
## script to do data reformatting and (hopefully) do some modelling
setwd("C:/Users/notne/Research/GitHub/Gails_beetles")
library(ggplot2)
library(dplyr)
################################################################################
## read in data and make factors for field (field), location of sample (sloc: in crop
## or in margin) and sample number (snum)
## I've calculated abundance and species richness already  in the input data set
## did that in Excel
beetle <- read.csv("beetles.csv")
beetle$field <- factor(substr(beetle$Label, 1, 1))
beetle$sloc <- factor(substr(beetle$Label, 4, 4))
beetle$snum <- factor(substr(beetle$Label, 5, 5))
beetle$year <- factor(substr(beetle$Season.and.Year, 8, 12))
beetle$man <- factor(beetle$Management.Type)
levels(beetle$man) <- c("con","int")
################################################################################
## plots
## plot total abundance by field/year
field_year <- beetle %>%
group_by(field, year) %>%
summarise(tot = sum(abundance),
sdtot = sd(abundance))
ggplot(field_year, aes(x = year, y = tot)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_wrap(~field)
ggplot(field_year, aes(x = field, y = tot)) +
geom_point() +
geom_errorbar(aes(ymin = tot-(2*sdtot), ymax = tot+(2*sdtot)), width = 0.5) +
facet_wrap(~year)
################################################################################
## as above but split additionally by management type
trt <- beetle %>%
group_by(field, year, man) %>%
summarise(meanab = mean(abundance),
sdab = sd(abundance),
nobs = n())
## grid of plots of conventional versus integrated for each field/year
ggplot(trt, aes(x = man, y = meanab)) +
geom_point() +
geom_errorbar(aes(ymin = meanab-(2*sdab), ymax = meanab+(2*sdab), width = 0.25)) +
facet_grid(field ~ year) +
xlab("Management type")
## plot as above but using all the raw data not averaging over all traps
## and separating crop and margin sites by colour
beetle %>%
group_by(field, year, man, sloc)
ggplot(beetle, aes(x = man, y = abundance, colour = sloc)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year) +
xlab("Management type") +
scale_color_manual(values = c("C" = "steelblue", "M" = "tomato2"),
labels = c("C" = "Crop", "M" = "Margin")) +
labs(color = "Location")
View(beetle)
str(beetle)
beetle$crp <- factor(beetle$crop)
View(beetle)
View(beetle)
beetle$crp <- factor(beetle$Crop)
beetle %>% group_by(crp)
ggplot(beetle, aes(x = crp, y = abundance)) +
geom_jitter(width = 0.15)
ggplot(beetle, aes(x = crp, y = abundance)) +
geom_jitter(width = 0.15) +
facet(~field)
ggplot(beetle, aes(x = crp, y = abundance)) +
geom_jitter(width = 0.15) +
facet_wrap(~field)
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_wrap(~field)
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year)
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year) +
theme(axis.text.x = element_text(angle = 45))
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_grid(field ~ year) +
theme(axis.text.x = element_text(angle = 90))
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15) +
facet_wrap(~field) +
theme(axis.text.x = element_text(angle = 90))
ggplot(beetle, aes(x = crp, y = abundance, color = man)) +
geom_jitter(width = 0.15)
install.packages(brms)
install.packages("brms")
plot(cars)
plot(cars)
d2016 <- beetle %>%
filter(year == 2016)
library(brms)
View(d2016)
View(d2016)
View(d2016)
mod1 <- brm(data = d2016,
family = poisson,
formula =
abundance ~ 1,
prior(normal(0, 1.5), class = intercept),
iter - 2000, warmup = 1000, chains = 4, cores = 4,
seed = 5814)
mod1 <- brm(data = d2016,
family = poisson,
formula =
abundance ~ 1,
prior(normal(0, 1.5), class = intercept),
iter = 2000, warmup = 1000, chains = 4, cores = 4,
seed = 5814)
mod1 <- brm(data = d2016,
family = poisson,
formula =
abundance ~ 1,
prior(normal(0, 3), class = "intercept"),
iter = 2000, warmup = 1000, chains = 4, cores = 4,
seed = 5814)
mod1 <- brm(data = d2016,
family = poisson,
formula =
abundance ~ 1 + man,
prior(normal(0, 3), class = "intercept"),
iter = 2000, warmup = 1000, chains = 4, cores = 4,
seed = 5814)
mod1 <- brm(data = d2016,
family = poisson,
formula =
abundance ~ 1 + (1|man),
prior = c(
prior(normal(0, 5), class = "Intercept"),
prior(cauchy(0, 2), class = "sd")  # Prior for standard deviation of group effects
)
)
mod1
